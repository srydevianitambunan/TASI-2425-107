Tue 25 Mar 2025 09:52:44 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2022
state = INFO
reproducibility = True
data_path = dataset/
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False
config_file = /notebooks/CoNetBack.yaml

Training Hyper Parameters:
train_batch_size = 2048
learner = adam
learning_rate = 0.001
neg_sampling = {'uniform': 1}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4
epochs = 20

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.6, 0.2, 0.2]}, 'split_valid': {'RS': [0.6, 0.2, 0.2]}, 'group_by': 'user', 'order': 'RO', 'mode': 'full'}
repeatable = False
metrics = ['Recall', 'NDCG', 'Hit', 'MRR']
topk = [20]
valid_metric = Recall@20
valid_metric_bigger = True
eval_batch_size = 2048
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
source_domain = {'dataset': 'Amazon-KG-5core-Movies_and_TV', 'data_path': '/notebooks/Amazon-KG-v2.0-dataset/Amazon-KG-5core-Movies_and_TV', 'seq_separator': ' ', 'USER_ID_FIELD': 'user_id', 'ITEM_ID_FIELD': 'item_id', 'RATING_FIELD': 'rating', 'TIME_FIELD': 'timestamp', 'NEG_PREFIX': 'neg_', 'LABEL_FIELD': 'label', 'load_col': {'inter': ['user_id', 'item_id', 'rating'], 'kg': ['head_id', 'relation_id', 'tail_id'], 'link': ['item_id', 'entity_id']}, 'user_inter_num_interval': '[5,inf)', 'item_inter_num_interval': '[5,inf)', 'val_interval': {'rating': '[0,inf)'}, 'drop_filter_field': True, 'HEAD_ENTITY_ID_FIELD': 'head_id', 'TAIL_ENTITY_ID_FIELD': 'tail_id', 'RELATION_ID_FIELD': 'relation_id', 'ENTITY_ID_FIELD': 'entity_id'}
target_domain = {'dataset': 'Amazon-KG-5core-Books', 'data_path': '/notebooks/Amazon-KG-v2.0-dataset/Amazon-KG-5core-Books', 'seq_separator': ',', 'USER_ID_FIELD': 'user_id', 'ITEM_ID_FIELD': 'item_id', 'RATING_FIELD': 'rating', 'TIME_FIELD': 'timestamp', 'NEG_PREFIX': 'neg_', 'LABEL_FIELD': 'label', 'load_col': {'inter': ['user_id', 'item_id', 'rating'], 'kg': ['head_id', 'relation_id', 'tail_id'], 'link': ['item_id', 'entity_id']}, 'user_inter_num_interval': '[5,inf)', 'item_inter_num_interval': '[5,inf)', 'val_interval': {'rating': '[0,inf)'}, 'drop_filter_field': True, 'HEAD_ENTITY_ID_FIELD': 'head_id', 'TAIL_ENTITY_ID_FIELD': 'tail_id', 'RELATION_ID_FIELD': 'relation_id', 'ENTITY_ID_FIELD': 'entity_id'}

Other Hyper Parameters: 
wandb_project = recbole_cdr
train_epochs = ['BOTH:20']
require_pow = False
embedding_size = 64
reg_weight = 0.01
mlp_hidden_size = [64, 32, 16, 8]
MODEL_TYPE = ModelType.CROSSDOMAIN
num_forward_layers = 2
num_backward_layers = 2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
train_modes = ['BOTH']
epoch_num = ['20']
source_split = False
device = cuda
train_neg_sample_args = {'strategy': 'by', 'by': 1, 'distribution': 'uniform', 'dynamic': 'none'}
eval_neg_sample_args = {'strategy': 'full', 'distribution': 'uniform'}


Tue 25 Mar 2025 09:52:46 INFO  Source domain: Amazon-KG-5core-Movies_and_TV
The number of users: 4950
Average actions of users: 11.844210951707415
The number of items: 2630
Average actions of items: 22.296310384176493
The number of inters: 58617
The sparsity of the dataset: 99.54974075354303%
Remain Fields: ['source_user_id', 'source_item_id', 'source_rating']
Target domain: Amazon-KG-5core-Books
The number of users: 9416
Average actions of users: 10.893786510886883
The number of items: 4876
Average actions of items: 21.038974358974357
The number of inters: 102565
The sparsity of the dataset: 99.7766072689357%
Remain Fields: ['target_user_id', 'target_item_id', 'target_rating']
Num of overlapped user: 956
Num of overlapped item: 1
Tue 25 Mar 2025 09:52:47 INFO  [Training]: train_batch_size = [2048] negative sampling: [{'uniform': 1}]
Tue 25 Mar 2025 09:52:47 INFO  [Evaluation]: eval_batch_size = [2048] eval_args: [{'split': {'RS': [0.6, 0.2, 0.2]}, 'split_valid': {'RS': [0.6, 0.2, 0.2]}, 'group_by': 'user', 'order': 'RO', 'mode': 'full'}]
Tue 25 Mar 2025 09:52:48 INFO  CoNet(
  (source_user_embedding): Embedding(13410, 64)
  (target_user_embedding): Embedding(13410, 64)
  (source_item_embedding): Embedding(7505, 64)
  (target_item_embedding): Embedding(7505, 64)
  (loss): BCELoss()
  (source_crossunit_linear): ModuleList(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): Linear(in_features=64, out_features=32, bias=True)
    (2): Linear(in_features=32, out_features=16, bias=True)
    (3): Linear(in_features=16, out_features=8, bias=True)
  )
  (source_crossunit_act): ModuleList(
    (0): ReLU()
    (1): ReLU()
    (2): ReLU()
    (3): ReLU()
  )
  (source_outputunit): Sequential(
    (0): Linear(in_features=8, out_features=1, bias=True)
    (1): Sigmoid()
  )
  (target_crossunit_linear): ModuleList(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): Linear(in_features=64, out_features=32, bias=True)
    (2): Linear(in_features=32, out_features=16, bias=True)
    (3): Linear(in_features=16, out_features=8, bias=True)
  )
  (target_crossunit_act): ModuleList(
    (0): ReLU()
    (1): ReLU()
    (2): ReLU()
    (3): ReLU()
  )
  (target_outputunit): Sequential(
    (0): Linear(in_features=8, out_features=1, bias=True)
    (1): Sigmoid()
  )
  (crossparas): ModuleList(
    (0): Linear(in_features=128, out_features=64, bias=False)
    (1): Linear(in_features=64, out_features=32, bias=False)
    (2): Linear(in_features=32, out_features=16, bias=False)
    (3): Linear(in_features=16, out_features=8, bias=False)
  )
)
Trainable parameters: 2710018
Tue 25 Mar 2025 09:52:48 INFO  Start training with BOTH mode
Tue 25 Mar 2025 09:52:50 INFO  epoch 0 training [time: 1.96s, train loss: 1370.7333]
Tue 25 Mar 2025 09:53:25 INFO  epoch 0 evaluating [time: 34.92s, valid_score: 0.055600]
Tue 25 Mar 2025 09:53:25 INFO  valid result: 
recall@20 : 0.0556    ndcg@20 : 0.0273    hit@20 : 0.0895    mrr@20 : 0.0254
Tue 25 Mar 2025 09:53:25 INFO  Saving current: saved/CoNet-Mar-25-2025_09-52-48.pth
Tue 25 Mar 2025 09:53:27 INFO  epoch 1 training [time: 1.88s, train loss: 909.1012]
Tue 25 Mar 2025 09:54:08 INFO  epoch 1 evaluating [time: 40.92s, valid_score: 0.058700]
Tue 25 Mar 2025 09:54:08 INFO  valid result: 
recall@20 : 0.0587    ndcg@20 : 0.0266    hit@20 : 0.0937    mrr@20 : 0.0228
Tue 25 Mar 2025 09:54:08 INFO  Saving current: saved/CoNet-Mar-25-2025_09-52-48.pth
Tue 25 Mar 2025 09:54:10 INFO  epoch 2 training [time: 1.89s, train loss: 570.9070]
Tue 25 Mar 2025 09:54:45 INFO  epoch 2 evaluating [time: 35.45s, valid_score: 0.058900]
Tue 25 Mar 2025 09:54:45 INFO  valid result: 
recall@20 : 0.0589    ndcg@20 : 0.0273    hit@20 : 0.0938    mrr@20 : 0.0254
Tue 25 Mar 2025 09:54:45 INFO  Saving current: saved/CoNet-Mar-25-2025_09-52-48.pth
Tue 25 Mar 2025 09:54:47 INFO  epoch 3 training [time: 1.62s, train loss: 342.4226]
Tue 25 Mar 2025 09:55:22 INFO  epoch 3 evaluating [time: 34.54s, valid_score: 0.056600]
Tue 25 Mar 2025 09:55:22 INFO  valid result: 
recall@20 : 0.0566    ndcg@20 : 0.0261    hit@20 : 0.0922    mrr@20 : 0.0242
Tue 25 Mar 2025 09:55:23 INFO  epoch 4 training [time: 1.68s, train loss: 210.4715]
Tue 25 Mar 2025 09:55:57 INFO  epoch 4 evaluating [time: 33.25s, valid_score: 0.057900]
Tue 25 Mar 2025 09:55:57 INFO  valid result: 
recall@20 : 0.0579    ndcg@20 : 0.0281    hit@20 : 0.0938    mrr@20 : 0.027
Tue 25 Mar 2025 09:55:58 INFO  epoch 5 training [time: 1.81s, train loss: 135.4567]
Tue 25 Mar 2025 09:56:25 INFO  epoch 5 evaluating [time: 27.07s, valid_score: 0.061000]
Tue 25 Mar 2025 09:56:25 INFO  valid result: 
recall@20 : 0.061    ndcg@20 : 0.0289    hit@20 : 0.0997    mrr@20 : 0.0269
Tue 25 Mar 2025 09:56:25 INFO  Saving current: saved/CoNet-Mar-25-2025_09-52-48.pth
Tue 25 Mar 2025 09:56:27 INFO  epoch 6 training [time: 1.79s, train loss: 91.7542]
Tue 25 Mar 2025 09:57:04 INFO  epoch 6 evaluating [time: 37.05s, valid_score: 0.062300]
Tue 25 Mar 2025 09:57:04 INFO  valid result: 
recall@20 : 0.0623    ndcg@20 : 0.0302    hit@20 : 0.0981    mrr@20 : 0.0283
Tue 25 Mar 2025 09:57:04 INFO  Saving current: saved/CoNet-Mar-25-2025_09-52-48.pth
Tue 25 Mar 2025 09:57:06 INFO  epoch 7 training [time: 1.93s, train loss: 65.5838]
Tue 25 Mar 2025 09:57:44 INFO  epoch 7 evaluating [time: 37.23s, valid_score: 0.060100]
Tue 25 Mar 2025 09:57:44 INFO  valid result: 
recall@20 : 0.0601    ndcg@20 : 0.0287    hit@20 : 0.0938    mrr@20 : 0.0267
Tue 25 Mar 2025 09:57:46 INFO  epoch 8 training [time: 1.94s, train loss: 49.5661]
Tue 25 Mar 2025 09:58:13 INFO  epoch 8 evaluating [time: 26.99s, valid_score: 0.059500]
Tue 25 Mar 2025 09:58:13 INFO  valid result: 
recall@20 : 0.0595    ndcg@20 : 0.0279    hit@20 : 0.0914    mrr@20 : 0.0254
Tue 25 Mar 2025 09:58:14 INFO  epoch 9 training [time: 1.68s, train loss: 40.1656]
Tue 25 Mar 2025 09:58:50 INFO  epoch 9 evaluating [time: 36.19s, valid_score: 0.057500]
Tue 25 Mar 2025 09:58:50 INFO  valid result: 
recall@20 : 0.0575    ndcg@20 : 0.0261    hit@20 : 0.089    mrr@20 : 0.0227
Tue 25 Mar 2025 09:58:52 INFO  epoch 10 training [time: 1.73s, train loss: 36.4169]
Tue 25 Mar 2025 09:59:31 INFO  epoch 10 evaluating [time: 38.97s, valid_score: 0.061300]
Tue 25 Mar 2025 09:59:31 INFO  valid result: 
recall@20 : 0.0613    ndcg@20 : 0.028    hit@20 : 0.0943    mrr@20 : 0.0239
Tue 25 Mar 2025 09:59:33 INFO  epoch 11 training [time: 1.69s, train loss: 33.8902]
Tue 25 Mar 2025 10:00:06 INFO  epoch 11 evaluating [time: 33.11s, valid_score: 0.058000]
Tue 25 Mar 2025 10:00:06 INFO  valid result: 
recall@20 : 0.058    ndcg@20 : 0.026    hit@20 : 0.0874    mrr@20 : 0.0218
Tue 25 Mar 2025 10:00:07 INFO  epoch 12 training [time: 1.61s, train loss: 31.5770]
Tue 25 Mar 2025 10:00:45 INFO  epoch 12 evaluating [time: 37.46s, valid_score: 0.057800]
Tue 25 Mar 2025 10:00:45 INFO  valid result: 
recall@20 : 0.0578    ndcg@20 : 0.0262    hit@20 : 0.0874    mrr@20 : 0.0218
Tue 25 Mar 2025 10:00:47 INFO  epoch 13 training [time: 1.82s, train loss: 29.5598]
Tue 25 Mar 2025 10:01:26 INFO  epoch 13 evaluating [time: 38.99s, valid_score: 0.057200]
Tue 25 Mar 2025 10:01:26 INFO  valid result: 
recall@20 : 0.0572    ndcg@20 : 0.0266    hit@20 : 0.0881    mrr@20 : 0.0221
Tue 25 Mar 2025 10:01:28 INFO  epoch 14 training [time: 1.85s, train loss: 27.9167]
Tue 25 Mar 2025 10:02:09 INFO  epoch 14 evaluating [time: 41.79s, valid_score: 0.061800]
Tue 25 Mar 2025 10:02:09 INFO  valid result: 
recall@20 : 0.0618    ndcg@20 : 0.0276    hit@20 : 0.0924    mrr@20 : 0.0225
Tue 25 Mar 2025 10:02:11 INFO  epoch 15 training [time: 2.02s, train loss: 26.4314]
Tue 25 Mar 2025 10:02:44 INFO  epoch 15 evaluating [time: 32.62s, valid_score: 0.066500]
Tue 25 Mar 2025 10:02:44 INFO  valid result: 
recall@20 : 0.0665    ndcg@20 : 0.0297    hit@20 : 0.0987    mrr@20 : 0.0239
Tue 25 Mar 2025 10:02:44 INFO  Saving current: saved/CoNet-Mar-25-2025_09-52-48.pth
Tue 25 Mar 2025 10:02:46 INFO  epoch 16 training [time: 1.86s, train loss: 25.5538]
Tue 25 Mar 2025 10:03:19 INFO  epoch 16 evaluating [time: 33.04s, valid_score: 0.063200]
Tue 25 Mar 2025 10:03:19 INFO  valid result: 
recall@20 : 0.0632    ndcg@20 : 0.0279    hit@20 : 0.0927    mrr@20 : 0.0222
Tue 25 Mar 2025 10:03:21 INFO  epoch 17 training [time: 1.74s, train loss: 24.4749]
Tue 25 Mar 2025 10:03:52 INFO  epoch 17 evaluating [time: 30.85s, valid_score: 0.071000]
Tue 25 Mar 2025 10:03:52 INFO  valid result: 
recall@20 : 0.071    ndcg@20 : 0.0323    hit@20 : 0.1088    mrr@20 : 0.0271
Tue 25 Mar 2025 10:03:52 INFO  Saving current: saved/CoNet-Mar-25-2025_09-52-48.pth
Tue 25 Mar 2025 10:03:53 INFO  epoch 18 training [time: 1.83s, train loss: 23.4243]
Tue 25 Mar 2025 10:04:32 INFO  epoch 18 evaluating [time: 38.08s, valid_score: 0.063700]
Tue 25 Mar 2025 10:04:32 INFO  valid result: 
recall@20 : 0.0637    ndcg@20 : 0.0293    hit@20 : 0.0945    mrr@20 : 0.0237
Tue 25 Mar 2025 10:04:33 INFO  epoch 19 training [time: 1.83s, train loss: 22.4932]
Tue 25 Mar 2025 10:05:13 INFO  epoch 19 evaluating [time: 39.22s, valid_score: 0.068300]
Tue 25 Mar 2025 10:05:13 INFO  valid result: 
recall@20 : 0.0683    ndcg@20 : 0.0315    hit@20 : 0.103    mrr@20 : 0.026
Tue 25 Mar 2025 10:05:13 INFO  Loading model structure and parameters from saved/CoNet-Mar-25-2025_09-52-48.pth
Tue 25 Mar 2025 10:05:47 INFO  best valid : OrderedDict([('recall@20', 0.071), ('ndcg@20', 0.0323), ('hit@20', 0.1088), ('mrr@20', 0.0271)])
Tue 25 Mar 2025 10:05:47 INFO  test result: OrderedDict([('recall@20', 0.0714), ('ndcg@20', 0.031), ('hit@20', 0.1074), ('mrr@20', 0.0248)])
