Fri 21 Mar 2025 03:20:08 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2022
state = INFO
reproducibility = True
data_path = dataset/
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False
config_file = ../testing.yaml

Training Hyper Parameters:
train_batch_size = 2048
learner = adam
learning_rate = 0.001
neg_sampling = {'uniform': 1}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4
epochs = 300

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'split_valid': {'RS': [0.8, 0.2]}, 'group_by': 'user', 'order': 'RO', 'mode': 'full'}
repeatable = False
metrics = ['Recall', 'NDCG']
topk = [10, 20]
valid_metric = Recall@10
valid_metric_bigger = True
eval_batch_size = 2048
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
source_domain = {'dataset': 'ml-100k', 'data_path': '/notebooks/RecBole-CDR/recbole_cdr/config/../dataset_example/ml-100k', 'seq_separator': ' ', 'USER_ID_FIELD': 'user_id', 'ITEM_ID_FIELD': 'item_id', 'RATING_FIELD': 'rating', 'TIME_FIELD': 'timestamp', 'NEG_PREFIX': 'neg_', 'LABEL_FIELD': 'label', 'load_col': {'inter': ['user_id', 'item_id', 'rating']}, 'user_inter_num_interval': '[5,inf)', 'item_inter_num_interval': '[5,inf)', 'val_interval': {'rating': '[3,inf)'}, 'drop_filter_field': True}
target_domain = {'dataset': 'ml-1m', 'data_path': '/notebooks/RecBole-CDR/recbole_cdr/config/../dataset_example/ml-1m', 'seq_separator': ',', 'USER_ID_FIELD': 'user_id', 'ITEM_ID_FIELD': 'item_id', 'RATING_FIELD': 'rating', 'TIME_FIELD': 'timestamp', 'NEG_PREFIX': 'neg_', 'LABEL_FIELD': 'label', 'load_col': {'inter': ['user_id', 'item_id', 'rating']}, 'user_inter_num_interval': '[5,inf)', 'item_inter_num_interval': '[5,inf)', 'val_interval': {'rating': '[3,inf)'}, 'drop_filter_field': True}

Other Hyper Parameters: 
wandb_project = recbole_cdr
train_epochs = ['BOTH:300']
require_pow = False
embedding_size = 64
alpha = 0.5
lambda = 0
gamma = 0
MODEL_TYPE = ModelType.CROSSDOMAIN
num_forward_layers = 2
num_backward_layers = 2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
train_modes = ['BOTH']
epoch_num = ['300']
source_split = False
device = cuda
train_neg_sample_args = {'strategy': 'by', 'by': 1, 'distribution': 'uniform', 'dynamic': 'none'}
eval_neg_sample_args = {'strategy': 'full', 'distribution': 'uniform'}


Fri 21 Mar 2025 03:20:15 INFO  Source domain: ml-100k
The number of users: 944
Average actions of users: 86.64369034994698
The number of items: 1197
Average actions of items: 68.31521739130434
The number of inters: 81705
The sparsity of the dataset: 92.76926426235079%
Remain Fields: ['source_user_id', 'source_item_id', 'source_rating']
Target domain: ml-1m
The number of users: 6039
Average actions of users: 138.42149718449818
The number of items: 3308
Average actions of items: 252.73329301481706
The number of inters: 835789
The sparsity of the dataset: 95.81624619337467%
Remain Fields: ['target_user_id', 'target_item_id', 'target_rating']
Num of overlapped user: 1
Num of overlapped item: 1154
Fri 21 Mar 2025 03:20:17 INFO  [Training]: train_batch_size = [2048] negative sampling: [{'uniform': 1}]
Fri 21 Mar 2025 03:20:17 INFO  [Evaluation]: eval_batch_size = [2048] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'split_valid': {'RS': [0.8, 0.2]}, 'group_by': 'user', 'order': 'RO', 'mode': 'full'}]
Fri 21 Mar 2025 03:20:18 INFO  CMF(
  (user_embedding): Embedding(6982, 64)
  (item_embedding): Embedding(3351, 64)
  (sigmoid): Sigmoid()
  (loss): BCELoss()
  (source_reg_loss): EmbLoss()
  (target_reg_loss): EmbLoss()
)
Trainable parameters: 661312
Fri 21 Mar 2025 03:20:18 INFO  Start training with BOTH mode
Fri 21 Mar 2025 03:20:21 INFO  epoch 0 training [time: 3.00s, train loss: 378.8121]
Fri 21 Mar 2025 03:20:36 INFO  epoch 0 evaluating [time: 14.61s, valid_score: 0.066800]
Fri 21 Mar 2025 03:20:36 INFO  valid result: 
recall@10 : 0.0668    recall@20 : 0.1125    ndcg@10 : 0.0978    ndcg@20 : 0.1064
Fri 21 Mar 2025 03:20:36 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:20:39 INFO  epoch 1 training [time: 3.16s, train loss: 297.3210]
Fri 21 Mar 2025 03:20:52 INFO  epoch 1 evaluating [time: 12.68s, valid_score: 0.072900]
Fri 21 Mar 2025 03:20:52 INFO  valid result: 
recall@10 : 0.0729    recall@20 : 0.1223    ndcg@10 : 0.1078    ndcg@20 : 0.1168
Fri 21 Mar 2025 03:20:52 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:20:55 INFO  epoch 2 training [time: 2.94s, train loss: 273.0101]
Fri 21 Mar 2025 03:21:06 INFO  epoch 2 evaluating [time: 11.46s, valid_score: 0.080600]
Fri 21 Mar 2025 03:21:06 INFO  valid result: 
recall@10 : 0.0806    recall@20 : 0.1354    ndcg@10 : 0.1202    ndcg@20 : 0.1287
Fri 21 Mar 2025 03:21:06 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:21:09 INFO  epoch 3 training [time: 3.10s, train loss: 254.6179]
Fri 21 Mar 2025 03:21:21 INFO  epoch 3 evaluating [time: 11.46s, valid_score: 0.087300]
Fri 21 Mar 2025 03:21:21 INFO  valid result: 
recall@10 : 0.0873    recall@20 : 0.1468    ndcg@10 : 0.1314    ndcg@20 : 0.1407
Fri 21 Mar 2025 03:21:21 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:21:24 INFO  epoch 4 training [time: 2.91s, train loss: 239.0184]
Fri 21 Mar 2025 03:21:34 INFO  epoch 4 evaluating [time: 9.98s, valid_score: 0.096500]
Fri 21 Mar 2025 03:21:34 INFO  valid result: 
recall@10 : 0.0965    recall@20 : 0.16    ndcg@10 : 0.1398    ndcg@20 : 0.1504
Fri 21 Mar 2025 03:21:34 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:21:37 INFO  epoch 5 training [time: 2.99s, train loss: 225.0440]
Fri 21 Mar 2025 03:21:49 INFO  epoch 5 evaluating [time: 12.86s, valid_score: 0.103300]
Fri 21 Mar 2025 03:21:49 INFO  valid result: 
recall@10 : 0.1033    recall@20 : 0.1681    ndcg@10 : 0.1465    ndcg@20 : 0.1574
Fri 21 Mar 2025 03:21:49 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:21:52 INFO  epoch 6 training [time: 2.99s, train loss: 212.9406]
Fri 21 Mar 2025 03:22:07 INFO  epoch 6 evaluating [time: 14.22s, valid_score: 0.108200]
Fri 21 Mar 2025 03:22:07 INFO  valid result: 
recall@10 : 0.1082    recall@20 : 0.1761    ndcg@10 : 0.1514    ndcg@20 : 0.1633
Fri 21 Mar 2025 03:22:07 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:22:10 INFO  epoch 7 training [time: 3.10s, train loss: 202.3161]
Fri 21 Mar 2025 03:22:23 INFO  epoch 7 evaluating [time: 13.58s, valid_score: 0.112800]
Fri 21 Mar 2025 03:22:23 INFO  valid result: 
recall@10 : 0.1128    recall@20 : 0.1823    ndcg@10 : 0.1553    ndcg@20 : 0.1677
Fri 21 Mar 2025 03:22:23 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:22:26 INFO  epoch 8 training [time: 3.12s, train loss: 192.7060]
Fri 21 Mar 2025 03:22:41 INFO  epoch 8 evaluating [time: 14.44s, valid_score: 0.116500]
Fri 21 Mar 2025 03:22:41 INFO  valid result: 
recall@10 : 0.1165    recall@20 : 0.1863    ndcg@10 : 0.1587    ndcg@20 : 0.171
Fri 21 Mar 2025 03:22:41 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:22:44 INFO  epoch 9 training [time: 3.17s, train loss: 184.5003]
Fri 21 Mar 2025 03:22:58 INFO  epoch 9 evaluating [time: 14.25s, valid_score: 0.120800]
Fri 21 Mar 2025 03:22:58 INFO  valid result: 
recall@10 : 0.1208    recall@20 : 0.1919    ndcg@10 : 0.1627    ndcg@20 : 0.1757
Fri 21 Mar 2025 03:22:58 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:23:01 INFO  epoch 10 training [time: 2.94s, train loss: 177.4553]
Fri 21 Mar 2025 03:23:13 INFO  epoch 10 evaluating [time: 11.19s, valid_score: 0.123600]
Fri 21 Mar 2025 03:23:13 INFO  valid result: 
recall@10 : 0.1236    recall@20 : 0.1941    ndcg@10 : 0.1649    ndcg@20 : 0.1775
Fri 21 Mar 2025 03:23:13 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:23:15 INFO  epoch 11 training [time: 2.89s, train loss: 171.0785]
Fri 21 Mar 2025 03:23:25 INFO  epoch 11 evaluating [time: 9.74s, valid_score: 0.124900]
Fri 21 Mar 2025 03:23:25 INFO  valid result: 
recall@10 : 0.1249    recall@20 : 0.1973    ndcg@10 : 0.1661    ndcg@20 : 0.1795
Fri 21 Mar 2025 03:23:25 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:23:28 INFO  epoch 12 training [time: 2.96s, train loss: 165.6525]
Fri 21 Mar 2025 03:23:38 INFO  epoch 12 evaluating [time: 9.96s, valid_score: 0.126400]
Fri 21 Mar 2025 03:23:38 INFO  valid result: 
recall@10 : 0.1264    recall@20 : 0.1999    ndcg@10 : 0.1669    ndcg@20 : 0.1807
Fri 21 Mar 2025 03:23:38 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:23:41 INFO  epoch 13 training [time: 3.03s, train loss: 160.6690]
Fri 21 Mar 2025 03:23:54 INFO  epoch 13 evaluating [time: 13.23s, valid_score: 0.127800]
Fri 21 Mar 2025 03:23:54 INFO  valid result: 
recall@10 : 0.1278    recall@20 : 0.2026    ndcg@10 : 0.1676    ndcg@20 : 0.1825
Fri 21 Mar 2025 03:23:54 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:23:57 INFO  epoch 14 training [time: 3.09s, train loss: 156.0115]
Fri 21 Mar 2025 03:24:13 INFO  epoch 14 evaluating [time: 15.88s, valid_score: 0.129000]
Fri 21 Mar 2025 03:24:13 INFO  valid result: 
recall@10 : 0.129    recall@20 : 0.2035    ndcg@10 : 0.168    ndcg@20 : 0.1828
Fri 21 Mar 2025 03:24:13 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:24:16 INFO  epoch 15 training [time: 2.98s, train loss: 152.1548]
Fri 21 Mar 2025 03:24:32 INFO  epoch 15 evaluating [time: 15.39s, valid_score: 0.128500]
Fri 21 Mar 2025 03:24:32 INFO  valid result: 
recall@10 : 0.1285    recall@20 : 0.2035    ndcg@10 : 0.1668    ndcg@20 : 0.1823
Fri 21 Mar 2025 03:24:35 INFO  epoch 16 training [time: 2.92s, train loss: 148.4413]
Fri 21 Mar 2025 03:24:51 INFO  epoch 16 evaluating [time: 16.46s, valid_score: 0.129400]
Fri 21 Mar 2025 03:24:51 INFO  valid result: 
recall@10 : 0.1294    recall@20 : 0.2034    ndcg@10 : 0.1667    ndcg@20 : 0.182
Fri 21 Mar 2025 03:24:51 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:24:54 INFO  epoch 17 training [time: 3.14s, train loss: 145.6202]
Fri 21 Mar 2025 03:25:04 INFO  epoch 17 evaluating [time: 9.88s, valid_score: 0.129200]
Fri 21 Mar 2025 03:25:04 INFO  valid result: 
recall@10 : 0.1292    recall@20 : 0.2032    ndcg@10 : 0.1661    ndcg@20 : 0.1817
Fri 21 Mar 2025 03:25:07 INFO  epoch 18 training [time: 3.04s, train loss: 142.5028]
Fri 21 Mar 2025 03:25:16 INFO  epoch 18 evaluating [time: 8.73s, valid_score: 0.129100]
Fri 21 Mar 2025 03:25:16 INFO  valid result: 
recall@10 : 0.1291    recall@20 : 0.203    ndcg@10 : 0.1657    ndcg@20 : 0.1812
Fri 21 Mar 2025 03:25:19 INFO  epoch 19 training [time: 2.98s, train loss: 139.5260]
Fri 21 Mar 2025 03:25:32 INFO  epoch 19 evaluating [time: 13.30s, valid_score: 0.129200]
Fri 21 Mar 2025 03:25:32 INFO  valid result: 
recall@10 : 0.1292    recall@20 : 0.2065    ndcg@10 : 0.1652    ndcg@20 : 0.1817
Fri 21 Mar 2025 03:25:35 INFO  epoch 20 training [time: 3.08s, train loss: 137.3803]
Fri 21 Mar 2025 03:25:46 INFO  epoch 20 evaluating [time: 10.75s, valid_score: 0.128700]
Fri 21 Mar 2025 03:25:46 INFO  valid result: 
recall@10 : 0.1287    recall@20 : 0.2036    ndcg@10 : 0.1642    ndcg@20 : 0.1804
Fri 21 Mar 2025 03:25:49 INFO  epoch 21 training [time: 3.02s, train loss: 134.9069]
Fri 21 Mar 2025 03:26:00 INFO  epoch 21 evaluating [time: 10.99s, valid_score: 0.129700]
Fri 21 Mar 2025 03:26:00 INFO  valid result: 
recall@10 : 0.1297    recall@20 : 0.2033    ndcg@10 : 0.1642    ndcg@20 : 0.1801
Fri 21 Mar 2025 03:26:00 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:26:03 INFO  epoch 22 training [time: 3.01s, train loss: 132.8189]
Fri 21 Mar 2025 03:26:15 INFO  epoch 22 evaluating [time: 12.05s, valid_score: 0.129700]
Fri 21 Mar 2025 03:26:15 INFO  valid result: 
recall@10 : 0.1297    recall@20 : 0.2048    ndcg@10 : 0.1631    ndcg@20 : 0.1798
Fri 21 Mar 2025 03:26:15 INFO  Saving current: saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:26:18 INFO  epoch 23 training [time: 3.20s, train loss: 130.7198]
Fri 21 Mar 2025 03:26:28 INFO  epoch 23 evaluating [time: 9.26s, valid_score: 0.129300]
Fri 21 Mar 2025 03:26:28 INFO  valid result: 
recall@10 : 0.1293    recall@20 : 0.2047    ndcg@10 : 0.1621    ndcg@20 : 0.1789
Fri 21 Mar 2025 03:26:31 INFO  epoch 24 training [time: 3.00s, train loss: 129.0102]
Fri 21 Mar 2025 03:26:44 INFO  epoch 24 evaluating [time: 13.56s, valid_score: 0.128800]
Fri 21 Mar 2025 03:26:44 INFO  valid result: 
recall@10 : 0.1288    recall@20 : 0.2066    ndcg@10 : 0.1615    ndcg@20 : 0.1795
Fri 21 Mar 2025 03:26:47 INFO  epoch 25 training [time: 3.12s, train loss: 127.1901]
Fri 21 Mar 2025 03:27:04 INFO  epoch 25 evaluating [time: 16.37s, valid_score: 0.128300]
Fri 21 Mar 2025 03:27:04 INFO  valid result: 
recall@10 : 0.1283    recall@20 : 0.205    ndcg@10 : 0.1603    ndcg@20 : 0.1782
Fri 21 Mar 2025 03:27:07 INFO  epoch 26 training [time: 2.97s, train loss: 125.5828]
Fri 21 Mar 2025 03:27:18 INFO  epoch 26 evaluating [time: 11.23s, valid_score: 0.125500]
Fri 21 Mar 2025 03:27:18 INFO  valid result: 
recall@10 : 0.1255    recall@20 : 0.205    ndcg@10 : 0.1575    ndcg@20 : 0.1769
Fri 21 Mar 2025 03:27:21 INFO  epoch 27 training [time: 3.01s, train loss: 124.1646]
Fri 21 Mar 2025 03:27:37 INFO  epoch 27 evaluating [time: 16.47s, valid_score: 0.127300]
Fri 21 Mar 2025 03:27:37 INFO  valid result: 
recall@10 : 0.1273    recall@20 : 0.2041    ndcg@10 : 0.158    ndcg@20 : 0.1764
Fri 21 Mar 2025 03:27:40 INFO  epoch 28 training [time: 3.04s, train loss: 122.6569]
Fri 21 Mar 2025 03:27:57 INFO  epoch 28 evaluating [time: 16.51s, valid_score: 0.126600]
Fri 21 Mar 2025 03:27:57 INFO  valid result: 
recall@10 : 0.1266    recall@20 : 0.2043    ndcg@10 : 0.1566    ndcg@20 : 0.1755
Fri 21 Mar 2025 03:28:00 INFO  epoch 29 training [time: 2.97s, train loss: 121.4817]
Fri 21 Mar 2025 03:28:10 INFO  epoch 29 evaluating [time: 9.70s, valid_score: 0.125400]
Fri 21 Mar 2025 03:28:10 INFO  valid result: 
recall@10 : 0.1254    recall@20 : 0.2045    ndcg@10 : 0.1553    ndcg@20 : 0.1749
Fri 21 Mar 2025 03:28:13 INFO  epoch 30 training [time: 3.03s, train loss: 120.0571]
Fri 21 Mar 2025 03:28:25 INFO  epoch 30 evaluating [time: 12.62s, valid_score: 0.125700]
Fri 21 Mar 2025 03:28:25 INFO  valid result: 
recall@10 : 0.1257    recall@20 : 0.2021    ndcg@10 : 0.1551    ndcg@20 : 0.1739
Fri 21 Mar 2025 03:28:28 INFO  epoch 31 training [time: 3.03s, train loss: 118.9104]
Fri 21 Mar 2025 03:28:38 INFO  epoch 31 evaluating [time: 9.39s, valid_score: 0.124100]
Fri 21 Mar 2025 03:28:38 INFO  valid result: 
recall@10 : 0.1241    recall@20 : 0.2022    ndcg@10 : 0.1535    ndcg@20 : 0.173
Fri 21 Mar 2025 03:28:41 INFO  epoch 32 training [time: 2.97s, train loss: 117.8386]
Fri 21 Mar 2025 03:28:50 INFO  epoch 32 evaluating [time: 9.00s, valid_score: 0.123800]
Fri 21 Mar 2025 03:28:50 INFO  valid result: 
recall@10 : 0.1238    recall@20 : 0.2014    ndcg@10 : 0.1531    ndcg@20 : 0.1722
Fri 21 Mar 2025 03:28:53 INFO  epoch 33 training [time: 2.90s, train loss: 116.9895]
Fri 21 Mar 2025 03:29:09 INFO  epoch 33 evaluating [time: 16.18s, valid_score: 0.123400]
Fri 21 Mar 2025 03:29:09 INFO  valid result: 
recall@10 : 0.1234    recall@20 : 0.2015    ndcg@10 : 0.1525    ndcg@20 : 0.1718
Fri 21 Mar 2025 03:29:09 INFO  Finished training, best eval result in epoch 22
Fri 21 Mar 2025 03:29:09 INFO  Loading model structure and parameters from saved/CMF-Mar-21-2025_03-20-18.pth
Fri 21 Mar 2025 03:29:24 INFO  best valid : OrderedDict([('recall@10', 0.1297), ('recall@20', 0.2048), ('ndcg@10', 0.1631), ('ndcg@20', 0.1798)])
Fri 21 Mar 2025 03:29:24 INFO  test result: OrderedDict([('recall@10', 0.1456), ('recall@20', 0.2258), ('ndcg@10', 0.1982), ('ndcg@20', 0.2105)])
