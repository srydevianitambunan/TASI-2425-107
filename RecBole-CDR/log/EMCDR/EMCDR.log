Tue 25 Mar 2025 10:24:01 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2022
state = INFO
reproducibility = True
data_path = dataset/
checkpoint_dir = saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False
config_file = /notebooks/EMCDR.yaml

Training Hyper Parameters:
train_batch_size = 2048
learner = adam
learning_rate = 0.001
neg_sampling = {'uniform': 1}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4
epochs = 30

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.6, 0.2, 0.2]}, 'split_valid': {'RS': [0.8, 0.2]}, 'group_by': 'user', 'order': 'RO', 'mode': 'full'}
repeatable = False
metrics = ['Recall', 'NDCG', 'Hit', 'MRR']
topk = [20]
valid_metric = Recall@20
valid_metric_bigger = True
eval_batch_size = 2048
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
source_domain = {'dataset': 'Amazon-KG-5core-Books', 'data_path': '/notebooks/Amazon-KG-v2.0-dataset/Amazon-KG-5core-Books', 'seq_separator': ' ', 'USER_ID_FIELD': 'user_id', 'ITEM_ID_FIELD': 'item_id', 'RATING_FIELD': 'rating', 'TIME_FIELD': 'timestamp', 'NEG_PREFIX': 'neg_', 'LABEL_FIELD': 'label', 'load_col': {'inter': ['user_id', 'item_id', 'rating'], 'kg': ['head_id', 'relation_id', 'tail_id'], 'link': ['item_id', 'entity_id']}, 'user_inter_num_interval': '[5,inf)', 'item_inter_num_interval': '[5,inf)', 'val_interval': {'rating': '[0,inf)'}, 'drop_filter_field': True, 'HEAD_ENTITY_ID_FIELD': 'head_id', 'TAIL_ENTITY_ID_FIELD': 'tail_id', 'RELATION_ID_FIELD': 'relation_id', 'ENTITY_ID_FIELD': 'entity_id'}
target_domain = {'dataset': 'Amazon-KG-5core-Movies_and_TV', 'data_path': '/notebooks/Amazon-KG-v2.0-dataset/Amazon-KG-5core-Movies_and_TV', 'seq_separator': ',', 'USER_ID_FIELD': 'user_id', 'ITEM_ID_FIELD': 'item_id', 'RATING_FIELD': 'rating', 'TIME_FIELD': 'timestamp', 'NEG_PREFIX': 'neg_', 'LABEL_FIELD': 'label', 'load_col': {'inter': ['user_id', 'item_id', 'rating'], 'kg': ['head_id', 'relation_id', 'tail_id'], 'link': ['item_id', 'entity_id']}, 'user_inter_num_interval': '[5,inf)', 'item_inter_num_interval': '[5,inf)', 'val_interval': {'rating': '[0,inf)'}, 'drop_filter_field': True, 'HEAD_ENTITY_ID_FIELD': 'head_id', 'TAIL_ENTITY_ID_FIELD': 'tail_id', 'RELATION_ID_FIELD': 'relation_id', 'ENTITY_ID_FIELD': 'entity_id'}

Other Hyper Parameters: 
wandb_project = recbole_cdr
train_epochs = ['SOURCE:30', 'TARGET:30', 'OVERLAP:30']
require_pow = False
latent_factor_model = MF
loss_type = CE
source_embedding_size = 64
target_embedding_size = 64
reg_weight = 0.01
mapping_function = non_linear
mlp_hidden_size = [128]
overlap_batch_size = 100
MODEL_TYPE = ModelType.CROSSDOMAIN
embedding_size = 64
num_forward_layers = 2
num_backward_layers = 2
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
train_modes = ['SOURCE', 'TARGET', 'OVERLAP']
epoch_num = ['30', '30', '30']
source_split = True
device = cuda
train_neg_sample_args = {'strategy': 'by', 'by': 1, 'distribution': 'uniform', 'dynamic': 'none'}
eval_neg_sample_args = {'strategy': 'full', 'distribution': 'uniform'}


Tue 25 Mar 2025 10:24:03 INFO  Source domain: Amazon-KG-5core-Books
The number of users: 9416
Average actions of users: 10.893786510886883
The number of items: 4876
Average actions of items: 21.038974358974357
The number of inters: 102565
The sparsity of the dataset: 99.7766072689357%
Remain Fields: ['source_user_id', 'source_item_id', 'source_rating']
Target domain: Amazon-KG-5core-Movies_and_TV
The number of users: 4950
Average actions of users: 11.844210951707415
The number of items: 2630
Average actions of items: 22.296310384176493
The number of inters: 58617
The sparsity of the dataset: 99.54974075354303%
Remain Fields: ['target_user_id', 'target_item_id', 'target_rating']
Num of overlapped user: 956
Num of overlapped item: 1
Tue 25 Mar 2025 10:24:05 INFO  [Training]: train_batch_size = [2048] negative sampling: [{'uniform': 1}]
Tue 25 Mar 2025 10:24:05 INFO  [Evaluation]: eval_batch_size = [2048] eval_args: [{'split': {'RS': [0.6, 0.2, 0.2]}, 'split_valid': {'RS': [0.8, 0.2]}, 'group_by': 'user', 'order': 'RO', 'mode': 'full'}]
Tue 25 Mar 2025 10:24:06 INFO  EMCDR(
  (loss): MSELoss()
  (mapping): Sequential(
    (0): Linear(in_features=64, out_features=128, bias=True)
    (1): Tanh()
    (2): Linear(in_features=128, out_features=64, bias=True)
  )
  (source_user_embedding): Embedding(13410, 64)
  (source_item_embedding): Embedding(7505, 64)
  (target_user_embedding): Embedding(13410, 64)
  (target_item_embedding): Embedding(7505, 64)
  (reg_loss): EmbLoss()
  (map_loss): MSELoss()
)
Trainable parameters: 2693696
Tue 25 Mar 2025 10:24:06 INFO  Start training with SOURCE mode
Tue 25 Mar 2025 10:24:07 INFO  epoch 0 training [time: 0.31s, train loss: 41.4981]
Tue 25 Mar 2025 10:24:36 INFO  epoch 0 evaluating [time: 29.00s, valid_score: 0.010700]
Tue 25 Mar 2025 10:24:36 INFO  valid result: 
recall@20 : 0.0107    ndcg@20 : 0.0044    hit@20 : 0.0199    mrr@20 : 0.004
Tue 25 Mar 2025 10:24:36 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:24:36 INFO  epoch 1 training [time: 0.27s, train loss: 40.6477]
Tue 25 Mar 2025 10:25:02 INFO  epoch 1 evaluating [time: 25.60s, valid_score: 0.102000]
Tue 25 Mar 2025 10:25:02 INFO  valid result: 
recall@20 : 0.102    ndcg@20 : 0.0514    hit@20 : 0.1531    mrr@20 : 0.0484
Tue 25 Mar 2025 10:25:02 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:25:02 INFO  epoch 2 training [time: 0.29s, train loss: 35.2545]
Tue 25 Mar 2025 10:25:31 INFO  epoch 2 evaluating [time: 28.72s, valid_score: 0.125000]
Tue 25 Mar 2025 10:25:31 INFO  valid result: 
recall@20 : 0.125    ndcg@20 : 0.0618    hit@20 : 0.181    mrr@20 : 0.0557
Tue 25 Mar 2025 10:25:31 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:25:31 INFO  epoch 3 training [time: 0.32s, train loss: 23.0200]
Tue 25 Mar 2025 10:26:05 INFO  epoch 3 evaluating [time: 33.59s, valid_score: 0.132100]
Tue 25 Mar 2025 10:26:05 INFO  valid result: 
recall@20 : 0.1321    ndcg@20 : 0.0657    hit@20 : 0.1918    mrr@20 : 0.0589
Tue 25 Mar 2025 10:26:05 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:26:05 INFO  epoch 4 training [time: 0.39s, train loss: 14.6698]
Tue 25 Mar 2025 10:26:41 INFO  epoch 4 evaluating [time: 35.53s, valid_score: 0.150000]
Tue 25 Mar 2025 10:26:41 INFO  valid result: 
recall@20 : 0.15    ndcg@20 : 0.0749    hit@20 : 0.2141    mrr@20 : 0.0672
Tue 25 Mar 2025 10:26:41 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:26:41 INFO  epoch 5 training [time: 0.33s, train loss: 11.2517]
Tue 25 Mar 2025 10:27:18 INFO  epoch 5 evaluating [time: 36.51s, valid_score: 0.159400]
Tue 25 Mar 2025 10:27:18 INFO  valid result: 
recall@20 : 0.1594    ndcg@20 : 0.079    hit@20 : 0.2264    mrr@20 : 0.0695
Tue 25 Mar 2025 10:27:18 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:27:18 INFO  epoch 6 training [time: 0.31s, train loss: 9.4661]
Tue 25 Mar 2025 10:27:46 INFO  epoch 6 evaluating [time: 28.50s, valid_score: 0.167400]
Tue 25 Mar 2025 10:27:46 INFO  valid result: 
recall@20 : 0.1674    ndcg@20 : 0.0824    hit@20 : 0.237    mrr@20 : 0.0717
Tue 25 Mar 2025 10:27:46 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:27:47 INFO  epoch 7 training [time: 0.33s, train loss: 8.2544]
Tue 25 Mar 2025 10:28:17 INFO  epoch 7 evaluating [time: 29.94s, valid_score: 0.171200]
Tue 25 Mar 2025 10:28:17 INFO  valid result: 
recall@20 : 0.1712    ndcg@20 : 0.0847    hit@20 : 0.2408    mrr@20 : 0.0737
Tue 25 Mar 2025 10:28:17 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:28:17 INFO  epoch 8 training [time: 0.29s, train loss: 7.3630]
Tue 25 Mar 2025 10:28:42 INFO  epoch 8 evaluating [time: 24.65s, valid_score: 0.174700]
Tue 25 Mar 2025 10:28:42 INFO  valid result: 
recall@20 : 0.1747    ndcg@20 : 0.086    hit@20 : 0.2476    mrr@20 : 0.0751
Tue 25 Mar 2025 10:28:42 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:28:42 INFO  epoch 9 training [time: 0.32s, train loss: 6.5923]
Tue 25 Mar 2025 10:29:18 INFO  epoch 9 evaluating [time: 35.64s, valid_score: 0.176300]
Tue 25 Mar 2025 10:29:18 INFO  valid result: 
recall@20 : 0.1763    ndcg@20 : 0.0859    hit@20 : 0.2491    mrr@20 : 0.0741
Tue 25 Mar 2025 10:29:18 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:29:18 INFO  epoch 10 training [time: 0.29s, train loss: 5.9983]
Tue 25 Mar 2025 10:29:55 INFO  epoch 10 evaluating [time: 37.05s, valid_score: 0.177100]
Tue 25 Mar 2025 10:29:55 INFO  valid result: 
recall@20 : 0.1771    ndcg@20 : 0.086    hit@20 : 0.2498    mrr@20 : 0.0738
Tue 25 Mar 2025 10:29:55 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:29:56 INFO  epoch 11 training [time: 0.41s, train loss: 5.4671]
Tue 25 Mar 2025 10:30:29 INFO  epoch 11 evaluating [time: 33.92s, valid_score: 0.179100]
Tue 25 Mar 2025 10:30:29 INFO  valid result: 
recall@20 : 0.1791    ndcg@20 : 0.087    hit@20 : 0.2519    mrr@20 : 0.0746
Tue 25 Mar 2025 10:30:29 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:30:30 INFO  epoch 12 training [time: 0.35s, train loss: 5.0460]
Tue 25 Mar 2025 10:31:01 INFO  epoch 12 evaluating [time: 31.15s, valid_score: 0.182300]
Tue 25 Mar 2025 10:31:01 INFO  valid result: 
recall@20 : 0.1823    ndcg@20 : 0.088    hit@20 : 0.2565    mrr@20 : 0.0747
Tue 25 Mar 2025 10:31:01 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:31:01 INFO  epoch 13 training [time: 0.30s, train loss: 4.6497]
Tue 25 Mar 2025 10:31:30 INFO  epoch 13 evaluating [time: 28.39s, valid_score: 0.182000]
Tue 25 Mar 2025 10:31:30 INFO  valid result: 
recall@20 : 0.182    ndcg@20 : 0.0886    hit@20 : 0.2548    mrr@20 : 0.0763
Tue 25 Mar 2025 10:31:30 INFO  epoch 14 training [time: 0.43s, train loss: 4.3533]
Tue 25 Mar 2025 10:31:56 INFO  epoch 14 evaluating [time: 26.06s, valid_score: 0.180800]
Tue 25 Mar 2025 10:31:56 INFO  valid result: 
recall@20 : 0.1808    ndcg@20 : 0.0881    hit@20 : 0.2532    mrr@20 : 0.0756
Tue 25 Mar 2025 10:31:57 INFO  epoch 15 training [time: 0.35s, train loss: 4.0678]
Tue 25 Mar 2025 10:32:35 INFO  epoch 15 evaluating [time: 38.30s, valid_score: 0.180900]
Tue 25 Mar 2025 10:32:35 INFO  valid result: 
recall@20 : 0.1809    ndcg@20 : 0.0888    hit@20 : 0.253    mrr@20 : 0.0768
Tue 25 Mar 2025 10:32:35 INFO  epoch 16 training [time: 0.31s, train loss: 3.8111]
Tue 25 Mar 2025 10:33:13 INFO  epoch 16 evaluating [time: 38.06s, valid_score: 0.182800]
Tue 25 Mar 2025 10:33:13 INFO  valid result: 
recall@20 : 0.1828    ndcg@20 : 0.0889    hit@20 : 0.256    mrr@20 : 0.0758
Tue 25 Mar 2025 10:33:13 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:33:14 INFO  epoch 17 training [time: 0.29s, train loss: 3.6538]
Tue 25 Mar 2025 10:33:40 INFO  epoch 17 evaluating [time: 26.45s, valid_score: 0.181500]
Tue 25 Mar 2025 10:33:40 INFO  valid result: 
recall@20 : 0.1815    ndcg@20 : 0.0895    hit@20 : 0.2551    mrr@20 : 0.0772
Tue 25 Mar 2025 10:33:40 INFO  epoch 18 training [time: 0.33s, train loss: 3.4845]
Tue 25 Mar 2025 10:34:01 INFO  epoch 18 evaluating [time: 20.35s, valid_score: 0.180900]
Tue 25 Mar 2025 10:34:01 INFO  valid result: 
recall@20 : 0.1809    ndcg@20 : 0.0887    hit@20 : 0.2544    mrr@20 : 0.076
Tue 25 Mar 2025 10:34:01 INFO  epoch 19 training [time: 0.30s, train loss: 3.3491]
Tue 25 Mar 2025 10:34:23 INFO  epoch 19 evaluating [time: 22.04s, valid_score: 0.180600]
Tue 25 Mar 2025 10:34:23 INFO  valid result: 
recall@20 : 0.1806    ndcg@20 : 0.0891    hit@20 : 0.2544    mrr@20 : 0.077
Tue 25 Mar 2025 10:34:23 INFO  epoch 20 training [time: 0.41s, train loss: 3.2359]
Tue 25 Mar 2025 10:34:59 INFO  epoch 20 evaluating [time: 35.28s, valid_score: 0.181300]
Tue 25 Mar 2025 10:34:59 INFO  valid result: 
recall@20 : 0.1813    ndcg@20 : 0.0894    hit@20 : 0.2551    mrr@20 : 0.0775
Tue 25 Mar 2025 10:34:59 INFO  epoch 21 training [time: 0.29s, train loss: 3.1113]
Tue 25 Mar 2025 10:35:36 INFO  epoch 21 evaluating [time: 36.87s, valid_score: 0.179900]
Tue 25 Mar 2025 10:35:36 INFO  valid result: 
recall@20 : 0.1799    ndcg@20 : 0.0886    hit@20 : 0.2543    mrr@20 : 0.0766
Tue 25 Mar 2025 10:35:36 INFO  epoch 22 training [time: 0.32s, train loss: 3.0259]
Tue 25 Mar 2025 10:36:10 INFO  epoch 22 evaluating [time: 34.06s, valid_score: 0.177300]
Tue 25 Mar 2025 10:36:10 INFO  valid result: 
recall@20 : 0.1773    ndcg@20 : 0.0883    hit@20 : 0.2512    mrr@20 : 0.0765
Tue 25 Mar 2025 10:36:11 INFO  epoch 23 training [time: 0.31s, train loss: 2.9531]
Tue 25 Mar 2025 10:36:40 INFO  epoch 23 evaluating [time: 29.46s, valid_score: 0.179300]
Tue 25 Mar 2025 10:36:40 INFO  valid result: 
recall@20 : 0.1793    ndcg@20 : 0.0886    hit@20 : 0.2526    mrr@20 : 0.0763
Tue 25 Mar 2025 10:36:40 INFO  epoch 24 training [time: 0.26s, train loss: 2.8578]
Tue 25 Mar 2025 10:37:12 INFO  epoch 24 evaluating [time: 31.42s, valid_score: 0.179500]
Tue 25 Mar 2025 10:37:12 INFO  valid result: 
recall@20 : 0.1795    ndcg@20 : 0.0885    hit@20 : 0.2531    mrr@20 : 0.0762
Tue 25 Mar 2025 10:37:12 INFO  epoch 25 training [time: 0.33s, train loss: 2.7904]
Tue 25 Mar 2025 10:37:49 INFO  epoch 25 evaluating [time: 37.18s, valid_score: 0.180100]
Tue 25 Mar 2025 10:37:49 INFO  valid result: 
recall@20 : 0.1801    ndcg@20 : 0.0883    hit@20 : 0.2534    mrr@20 : 0.076
Tue 25 Mar 2025 10:37:50 INFO  epoch 26 training [time: 0.34s, train loss: 2.7508]
Tue 25 Mar 2025 10:38:21 INFO  epoch 26 evaluating [time: 31.44s, valid_score: 0.180200]
Tue 25 Mar 2025 10:38:21 INFO  valid result: 
recall@20 : 0.1802    ndcg@20 : 0.0883    hit@20 : 0.2542    mrr@20 : 0.0758
Tue 25 Mar 2025 10:38:21 INFO  epoch 27 training [time: 0.34s, train loss: 2.6657]
Tue 25 Mar 2025 10:38:57 INFO  epoch 27 evaluating [time: 35.69s, valid_score: 0.179400]
Tue 25 Mar 2025 10:38:57 INFO  valid result: 
recall@20 : 0.1794    ndcg@20 : 0.0882    hit@20 : 0.2526    mrr@20 : 0.076
Tue 25 Mar 2025 10:38:57 INFO  Finished training, best eval result in epoch 16
Tue 25 Mar 2025 10:38:57 INFO  Start training with TARGET mode
Tue 25 Mar 2025 10:38:57 INFO  epoch 0 training [time: 0.13s, train loss: 18.5011]
Tue 25 Mar 2025 10:39:09 INFO  epoch 0 evaluating [time: 11.48s, valid_score: 0.010400]
Tue 25 Mar 2025 10:39:09 INFO  valid result: 
recall@20 : 0.0104    ndcg@20 : 0.0047    hit@20 : 0.0238    mrr@20 : 0.0054
Tue 25 Mar 2025 10:39:09 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:39:09 INFO  epoch 1 training [time: 0.18s, train loss: 18.3338]
Tue 25 Mar 2025 10:39:20 INFO  epoch 1 evaluating [time: 10.83s, valid_score: 0.040000]
Tue 25 Mar 2025 10:39:20 INFO  valid result: 
recall@20 : 0.04    ndcg@20 : 0.0192    hit@20 : 0.0845    mrr@20 : 0.0206
Tue 25 Mar 2025 10:39:20 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:39:20 INFO  epoch 2 training [time: 0.14s, train loss: 17.8058]
Tue 25 Mar 2025 10:39:37 INFO  epoch 2 evaluating [time: 16.94s, valid_score: 0.089400]
Tue 25 Mar 2025 10:39:37 INFO  valid result: 
recall@20 : 0.0894    ndcg@20 : 0.0419    hit@20 : 0.1501    mrr@20 : 0.0398
Tue 25 Mar 2025 10:39:37 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:39:37 INFO  epoch 3 training [time: 0.16s, train loss: 16.1278]
Tue 25 Mar 2025 10:39:48 INFO  epoch 3 evaluating [time: 11.23s, valid_score: 0.105100]
Tue 25 Mar 2025 10:39:48 INFO  valid result: 
recall@20 : 0.1051    ndcg@20 : 0.0505    hit@20 : 0.1677    mrr@20 : 0.0478
Tue 25 Mar 2025 10:39:48 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:39:48 INFO  epoch 4 training [time: 0.15s, train loss: 12.8738]
Tue 25 Mar 2025 10:40:04 INFO  epoch 4 evaluating [time: 15.89s, valid_score: 0.108700]
Tue 25 Mar 2025 10:40:04 INFO  valid result: 
recall@20 : 0.1087    ndcg@20 : 0.0531    hit@20 : 0.1736    mrr@20 : 0.0508
Tue 25 Mar 2025 10:40:04 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:40:05 INFO  epoch 5 training [time: 0.16s, train loss: 9.3781]
Tue 25 Mar 2025 10:40:22 INFO  epoch 5 evaluating [time: 16.93s, valid_score: 0.119100]
Tue 25 Mar 2025 10:40:22 INFO  valid result: 
recall@20 : 0.1191    ndcg@20 : 0.058    hit@20 : 0.1863    mrr@20 : 0.0552
Tue 25 Mar 2025 10:40:22 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:40:22 INFO  epoch 6 training [time: 0.14s, train loss: 7.1500]
Tue 25 Mar 2025 10:40:38 INFO  epoch 6 evaluating [time: 16.27s, valid_score: 0.129600]
Tue 25 Mar 2025 10:40:38 INFO  valid result: 
recall@20 : 0.1296    ndcg@20 : 0.0635    hit@20 : 0.2011    mrr@20 : 0.0592
Tue 25 Mar 2025 10:40:38 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:40:38 INFO  epoch 7 training [time: 0.17s, train loss: 5.9370]
Tue 25 Mar 2025 10:40:55 INFO  epoch 7 evaluating [time: 16.58s, valid_score: 0.136700]
Tue 25 Mar 2025 10:40:55 INFO  valid result: 
recall@20 : 0.1367    ndcg@20 : 0.0658    hit@20 : 0.2097    mrr@20 : 0.0607
Tue 25 Mar 2025 10:40:55 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:40:55 INFO  epoch 8 training [time: 0.15s, train loss: 5.1983]
Tue 25 Mar 2025 10:41:04 INFO  epoch 8 evaluating [time: 9.24s, valid_score: 0.137100]
Tue 25 Mar 2025 10:41:04 INFO  valid result: 
recall@20 : 0.1371    ndcg@20 : 0.0659    hit@20 : 0.212    mrr@20 : 0.061
Tue 25 Mar 2025 10:41:04 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:41:04 INFO  epoch 9 training [time: 0.16s, train loss: 4.6698]
Tue 25 Mar 2025 10:41:21 INFO  epoch 9 evaluating [time: 17.04s, valid_score: 0.138700]
Tue 25 Mar 2025 10:41:21 INFO  valid result: 
recall@20 : 0.1387    ndcg@20 : 0.0667    hit@20 : 0.2142    mrr@20 : 0.0612
Tue 25 Mar 2025 10:41:22 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:41:22 INFO  epoch 10 training [time: 0.16s, train loss: 4.2219]
Tue 25 Mar 2025 10:41:39 INFO  epoch 10 evaluating [time: 17.15s, valid_score: 0.139600]
Tue 25 Mar 2025 10:41:39 INFO  valid result: 
recall@20 : 0.1396    ndcg@20 : 0.0668    hit@20 : 0.2156    mrr@20 : 0.0607
Tue 25 Mar 2025 10:41:39 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:41:39 INFO  epoch 11 training [time: 0.15s, train loss: 3.8766]
Tue 25 Mar 2025 10:41:56 INFO  epoch 11 evaluating [time: 16.53s, valid_score: 0.138700]
Tue 25 Mar 2025 10:41:56 INFO  valid result: 
recall@20 : 0.1387    ndcg@20 : 0.0666    hit@20 : 0.2168    mrr@20 : 0.0605
Tue 25 Mar 2025 10:41:56 INFO  epoch 12 training [time: 0.13s, train loss: 3.5560]
Tue 25 Mar 2025 10:42:13 INFO  epoch 12 evaluating [time: 17.68s, valid_score: 0.135700]
Tue 25 Mar 2025 10:42:13 INFO  valid result: 
recall@20 : 0.1357    ndcg@20 : 0.0652    hit@20 : 0.211    mrr@20 : 0.059
Tue 25 Mar 2025 10:42:14 INFO  epoch 13 training [time: 0.15s, train loss: 3.3118]
Tue 25 Mar 2025 10:42:29 INFO  epoch 13 evaluating [time: 15.18s, valid_score: 0.134100]
Tue 25 Mar 2025 10:42:29 INFO  valid result: 
recall@20 : 0.1341    ndcg@20 : 0.0648    hit@20 : 0.2073    mrr@20 : 0.0589
Tue 25 Mar 2025 10:42:29 INFO  epoch 14 training [time: 0.15s, train loss: 3.0724]
Tue 25 Mar 2025 10:42:46 INFO  epoch 14 evaluating [time: 17.49s, valid_score: 0.134000]
Tue 25 Mar 2025 10:42:46 INFO  valid result: 
recall@20 : 0.134    ndcg@20 : 0.0639    hit@20 : 0.2091    mrr@20 : 0.0576
Tue 25 Mar 2025 10:42:47 INFO  epoch 15 training [time: 0.16s, train loss: 2.8401]
Tue 25 Mar 2025 10:43:02 INFO  epoch 15 evaluating [time: 15.52s, valid_score: 0.134300]
Tue 25 Mar 2025 10:43:02 INFO  valid result: 
recall@20 : 0.1343    ndcg@20 : 0.0635    hit@20 : 0.2105    mrr@20 : 0.0575
Tue 25 Mar 2025 10:43:02 INFO  epoch 16 training [time: 0.13s, train loss: 2.6658]
Tue 25 Mar 2025 10:43:14 INFO  epoch 16 evaluating [time: 11.61s, valid_score: 0.132700]
Tue 25 Mar 2025 10:43:14 INFO  valid result: 
recall@20 : 0.1327    ndcg@20 : 0.0633    hit@20 : 0.2069    mrr@20 : 0.0572
Tue 25 Mar 2025 10:43:14 INFO  epoch 17 training [time: 0.15s, train loss: 2.5065]
Tue 25 Mar 2025 10:43:26 INFO  epoch 17 evaluating [time: 12.26s, valid_score: 0.134600]
Tue 25 Mar 2025 10:43:26 INFO  valid result: 
recall@20 : 0.1346    ndcg@20 : 0.0637    hit@20 : 0.2087    mrr@20 : 0.0571
Tue 25 Mar 2025 10:43:26 INFO  epoch 18 training [time: 0.15s, train loss: 2.3486]
Tue 25 Mar 2025 10:43:36 INFO  epoch 18 evaluating [time: 9.57s, valid_score: 0.134400]
Tue 25 Mar 2025 10:43:36 INFO  valid result: 
recall@20 : 0.1344    ndcg@20 : 0.0643    hit@20 : 0.2089    mrr@20 : 0.0578
Tue 25 Mar 2025 10:43:36 INFO  epoch 19 training [time: 0.14s, train loss: 2.2268]
Tue 25 Mar 2025 10:43:52 INFO  epoch 19 evaluating [time: 16.21s, valid_score: 0.135200]
Tue 25 Mar 2025 10:43:52 INFO  valid result: 
recall@20 : 0.1352    ndcg@20 : 0.0647    hit@20 : 0.2103    mrr@20 : 0.0578
Tue 25 Mar 2025 10:43:52 INFO  epoch 20 training [time: 0.22s, train loss: 2.1352]
Tue 25 Mar 2025 10:44:04 INFO  epoch 20 evaluating [time: 11.61s, valid_score: 0.136800]
Tue 25 Mar 2025 10:44:04 INFO  valid result: 
recall@20 : 0.1368    ndcg@20 : 0.0646    hit@20 : 0.2128    mrr@20 : 0.0576
Tue 25 Mar 2025 10:44:04 INFO  epoch 21 training [time: 0.13s, train loss: 2.0024]
Tue 25 Mar 2025 10:44:13 INFO  epoch 21 evaluating [time: 9.02s, valid_score: 0.136900]
Tue 25 Mar 2025 10:44:13 INFO  valid result: 
recall@20 : 0.1369    ndcg@20 : 0.0649    hit@20 : 0.212    mrr@20 : 0.0582
Tue 25 Mar 2025 10:44:13 INFO  Finished training, best eval result in epoch 10
Tue 25 Mar 2025 10:44:13 INFO  Start training with OVERLAP mode
Tue 25 Mar 2025 10:44:13 INFO  epoch 0 training [time: 0.03s, train loss: 0.2814]
Tue 25 Mar 2025 10:44:28 INFO  epoch 0 evaluating [time: 15.08s, valid_score: 0.122900]
Tue 25 Mar 2025 10:44:28 INFO  valid result: 
recall@20 : 0.1229    ndcg@20 : 0.0576    hit@20 : 0.1871    mrr@20 : 0.0495
Tue 25 Mar 2025 10:44:28 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:44:28 INFO  epoch 1 training [time: 0.04s, train loss: 0.1939]
Tue 25 Mar 2025 10:44:46 INFO  epoch 1 evaluating [time: 17.34s, valid_score: 0.126700]
Tue 25 Mar 2025 10:44:46 INFO  valid result: 
recall@20 : 0.1267    ndcg@20 : 0.0598    hit@20 : 0.1954    mrr@20 : 0.0518
Tue 25 Mar 2025 10:44:46 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:44:46 INFO  epoch 2 training [time: 0.03s, train loss: 0.1536]
Tue 25 Mar 2025 10:44:59 INFO  epoch 2 evaluating [time: 13.39s, valid_score: 0.128200]
Tue 25 Mar 2025 10:44:59 INFO  valid result: 
recall@20 : 0.1282    ndcg@20 : 0.061    hit@20 : 0.1988    mrr@20 : 0.0536
Tue 25 Mar 2025 10:44:59 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:44:59 INFO  epoch 3 training [time: 0.04s, train loss: 0.1278]
Tue 25 Mar 2025 10:45:16 INFO  epoch 3 evaluating [time: 16.93s, valid_score: 0.129200]
Tue 25 Mar 2025 10:45:16 INFO  valid result: 
recall@20 : 0.1292    ndcg@20 : 0.0614    hit@20 : 0.2008    mrr@20 : 0.0542
Tue 25 Mar 2025 10:45:16 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:45:16 INFO  epoch 4 training [time: 0.03s, train loss: 0.1120]
Tue 25 Mar 2025 10:45:33 INFO  epoch 4 evaluating [time: 16.75s, valid_score: 0.129000]
Tue 25 Mar 2025 10:45:33 INFO  valid result: 
recall@20 : 0.129    ndcg@20 : 0.0617    hit@20 : 0.2019    mrr@20 : 0.0554
Tue 25 Mar 2025 10:45:33 INFO  epoch 5 training [time: 0.03s, train loss: 0.1014]
Tue 25 Mar 2025 10:45:44 INFO  epoch 5 evaluating [time: 10.81s, valid_score: 0.129300]
Tue 25 Mar 2025 10:45:44 INFO  valid result: 
recall@20 : 0.1293    ndcg@20 : 0.0622    hit@20 : 0.2023    mrr@20 : 0.0563
Tue 25 Mar 2025 10:45:44 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:45:44 INFO  epoch 6 training [time: 0.03s, train loss: 0.0941]
Tue 25 Mar 2025 10:45:56 INFO  epoch 6 evaluating [time: 11.82s, valid_score: 0.130600]
Tue 25 Mar 2025 10:45:56 INFO  valid result: 
recall@20 : 0.1306    ndcg@20 : 0.0628    hit@20 : 0.2049    mrr@20 : 0.0569
Tue 25 Mar 2025 10:45:56 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:45:56 INFO  epoch 7 training [time: 0.04s, train loss: 0.0884]
Tue 25 Mar 2025 10:46:10 INFO  epoch 7 evaluating [time: 13.59s, valid_score: 0.131300]
Tue 25 Mar 2025 10:46:10 INFO  valid result: 
recall@20 : 0.1313    ndcg@20 : 0.0633    hit@20 : 0.2065    mrr@20 : 0.0578
Tue 25 Mar 2025 10:46:10 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:46:10 INFO  epoch 8 training [time: 0.04s, train loss: 0.0838]
Tue 25 Mar 2025 10:46:23 INFO  epoch 8 evaluating [time: 13.09s, valid_score: 0.131600]
Tue 25 Mar 2025 10:46:23 INFO  valid result: 
recall@20 : 0.1316    ndcg@20 : 0.0633    hit@20 : 0.2067    mrr@20 : 0.0575
Tue 25 Mar 2025 10:46:23 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:46:23 INFO  epoch 9 training [time: 0.03s, train loss: 0.0799]
Tue 25 Mar 2025 10:46:34 INFO  epoch 9 evaluating [time: 11.09s, valid_score: 0.131700]
Tue 25 Mar 2025 10:46:34 INFO  valid result: 
recall@20 : 0.1317    ndcg@20 : 0.0636    hit@20 : 0.2067    mrr@20 : 0.0578
Tue 25 Mar 2025 10:46:34 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:46:34 INFO  epoch 10 training [time: 0.03s, train loss: 0.0759]
Tue 25 Mar 2025 10:46:45 INFO  epoch 10 evaluating [time: 10.85s, valid_score: 0.131700]
Tue 25 Mar 2025 10:46:45 INFO  valid result: 
recall@20 : 0.1317    ndcg@20 : 0.0636    hit@20 : 0.2069    mrr@20 : 0.0581
Tue 25 Mar 2025 10:46:45 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:46:45 INFO  epoch 11 training [time: 0.03s, train loss: 0.0725]
Tue 25 Mar 2025 10:47:01 INFO  epoch 11 evaluating [time: 15.66s, valid_score: 0.132600]
Tue 25 Mar 2025 10:47:01 INFO  valid result: 
recall@20 : 0.1326    ndcg@20 : 0.0639    hit@20 : 0.2079    mrr@20 : 0.058
Tue 25 Mar 2025 10:47:01 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:47:01 INFO  epoch 12 training [time: 0.04s, train loss: 0.0697]
Tue 25 Mar 2025 10:47:14 INFO  epoch 12 evaluating [time: 13.66s, valid_score: 0.132700]
Tue 25 Mar 2025 10:47:14 INFO  valid result: 
recall@20 : 0.1327    ndcg@20 : 0.0641    hit@20 : 0.2085    mrr@20 : 0.0584
Tue 25 Mar 2025 10:47:14 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:47:14 INFO  epoch 13 training [time: 0.03s, train loss: 0.0669]
Tue 25 Mar 2025 10:47:29 INFO  epoch 13 evaluating [time: 14.64s, valid_score: 0.132800]
Tue 25 Mar 2025 10:47:29 INFO  valid result: 
recall@20 : 0.1328    ndcg@20 : 0.0641    hit@20 : 0.2081    mrr@20 : 0.0583
Tue 25 Mar 2025 10:47:29 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:47:29 INFO  epoch 14 training [time: 0.03s, train loss: 0.0642]
Tue 25 Mar 2025 10:47:46 INFO  epoch 14 evaluating [time: 16.73s, valid_score: 0.133200]
Tue 25 Mar 2025 10:47:46 INFO  valid result: 
recall@20 : 0.1332    ndcg@20 : 0.0643    hit@20 : 0.2087    mrr@20 : 0.0584
Tue 25 Mar 2025 10:47:46 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:47:46 INFO  epoch 15 training [time: 0.03s, train loss: 0.0618]
Tue 25 Mar 2025 10:49:12 INFO  epoch 15 evaluating [time: 86.29s, valid_score: 0.133400]
Tue 25 Mar 2025 10:49:12 INFO  valid result: 
recall@20 : 0.1334    ndcg@20 : 0.0645    hit@20 : 0.2085    mrr@20 : 0.0588
Tue 25 Mar 2025 10:49:12 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:49:12 INFO  epoch 16 training [time: 0.04s, train loss: 0.0594]
Tue 25 Mar 2025 10:49:30 INFO  epoch 16 evaluating [time: 17.36s, valid_score: 0.133400]
Tue 25 Mar 2025 10:49:30 INFO  valid result: 
recall@20 : 0.1334    ndcg@20 : 0.0647    hit@20 : 0.2085    mrr@20 : 0.0594
Tue 25 Mar 2025 10:49:30 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:49:30 INFO  epoch 17 training [time: 0.04s, train loss: 0.0572]
Tue 25 Mar 2025 10:49:42 INFO  epoch 17 evaluating [time: 12.49s, valid_score: 0.133400]
Tue 25 Mar 2025 10:49:42 INFO  valid result: 
recall@20 : 0.1334    ndcg@20 : 0.0645    hit@20 : 0.2085    mrr@20 : 0.0586
Tue 25 Mar 2025 10:49:42 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:49:42 INFO  epoch 18 training [time: 0.04s, train loss: 0.0549]
Tue 25 Mar 2025 10:49:58 INFO  epoch 18 evaluating [time: 15.70s, valid_score: 0.133600]
Tue 25 Mar 2025 10:49:58 INFO  valid result: 
recall@20 : 0.1336    ndcg@20 : 0.0648    hit@20 : 0.2091    mrr@20 : 0.0594
Tue 25 Mar 2025 10:49:58 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:49:58 INFO  epoch 19 training [time: 0.04s, train loss: 0.0530]
Tue 25 Mar 2025 10:50:16 INFO  epoch 19 evaluating [time: 17.73s, valid_score: 0.133100]
Tue 25 Mar 2025 10:50:16 INFO  valid result: 
recall@20 : 0.1331    ndcg@20 : 0.0646    hit@20 : 0.2077    mrr@20 : 0.0592
Tue 25 Mar 2025 10:50:16 INFO  epoch 20 training [time: 0.04s, train loss: 0.0511]
Tue 25 Mar 2025 10:50:34 INFO  epoch 20 evaluating [time: 17.86s, valid_score: 0.133700]
Tue 25 Mar 2025 10:50:34 INFO  valid result: 
recall@20 : 0.1337    ndcg@20 : 0.0648    hit@20 : 0.2085    mrr@20 : 0.0589
Tue 25 Mar 2025 10:50:34 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:50:34 INFO  epoch 21 training [time: 0.03s, train loss: 0.0491]
Tue 25 Mar 2025 10:50:53 INFO  epoch 21 evaluating [time: 18.60s, valid_score: 0.134600]
Tue 25 Mar 2025 10:50:53 INFO  valid result: 
recall@20 : 0.1346    ndcg@20 : 0.0652    hit@20 : 0.2097    mrr@20 : 0.0596
Tue 25 Mar 2025 10:50:53 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:50:53 INFO  epoch 22 training [time: 0.03s, train loss: 0.0471]
Tue 25 Mar 2025 10:51:07 INFO  epoch 22 evaluating [time: 14.77s, valid_score: 0.134100]
Tue 25 Mar 2025 10:51:07 INFO  valid result: 
recall@20 : 0.1341    ndcg@20 : 0.065    hit@20 : 0.2089    mrr@20 : 0.0595
Tue 25 Mar 2025 10:51:07 INFO  epoch 23 training [time: 0.03s, train loss: 0.0451]
Tue 25 Mar 2025 10:51:23 INFO  epoch 23 evaluating [time: 15.21s, valid_score: 0.134400]
Tue 25 Mar 2025 10:51:23 INFO  valid result: 
recall@20 : 0.1344    ndcg@20 : 0.0653    hit@20 : 0.2089    mrr@20 : 0.0596
Tue 25 Mar 2025 10:51:23 INFO  epoch 24 training [time: 0.04s, train loss: 0.0434]
Tue 25 Mar 2025 10:51:35 INFO  epoch 24 evaluating [time: 12.36s, valid_score: 0.134300]
Tue 25 Mar 2025 10:51:35 INFO  valid result: 
recall@20 : 0.1343    ndcg@20 : 0.0654    hit@20 : 0.2097    mrr@20 : 0.0602
Tue 25 Mar 2025 10:51:35 INFO  epoch 25 training [time: 0.04s, train loss: 0.0420]
Tue 25 Mar 2025 10:51:52 INFO  epoch 25 evaluating [time: 16.45s, valid_score: 0.134600]
Tue 25 Mar 2025 10:51:52 INFO  valid result: 
recall@20 : 0.1346    ndcg@20 : 0.0655    hit@20 : 0.2095    mrr@20 : 0.0602
Tue 25 Mar 2025 10:51:52 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:51:52 INFO  epoch 26 training [time: 0.03s, train loss: 0.0402]
Tue 25 Mar 2025 10:52:09 INFO  epoch 26 evaluating [time: 17.22s, valid_score: 0.134300]
Tue 25 Mar 2025 10:52:09 INFO  valid result: 
recall@20 : 0.1343    ndcg@20 : 0.0653    hit@20 : 0.2093    mrr@20 : 0.0602
Tue 25 Mar 2025 10:52:09 INFO  epoch 27 training [time: 0.03s, train loss: 0.0385]
Tue 25 Mar 2025 10:52:22 INFO  epoch 27 evaluating [time: 12.88s, valid_score: 0.134800]
Tue 25 Mar 2025 10:52:22 INFO  valid result: 
recall@20 : 0.1348    ndcg@20 : 0.0654    hit@20 : 0.2099    mrr@20 : 0.0599
Tue 25 Mar 2025 10:52:22 INFO  Saving current: saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:52:22 INFO  epoch 28 training [time: 0.03s, train loss: 0.0372]
Tue 25 Mar 2025 10:52:41 INFO  epoch 28 evaluating [time: 18.79s, valid_score: 0.134600]
Tue 25 Mar 2025 10:52:41 INFO  valid result: 
recall@20 : 0.1346    ndcg@20 : 0.0654    hit@20 : 0.2099    mrr@20 : 0.06
Tue 25 Mar 2025 10:52:41 INFO  epoch 29 training [time: 0.04s, train loss: 0.0359]
Tue 25 Mar 2025 10:52:55 INFO  epoch 29 evaluating [time: 14.52s, valid_score: 0.134200]
Tue 25 Mar 2025 10:52:55 INFO  valid result: 
recall@20 : 0.1342    ndcg@20 : 0.0655    hit@20 : 0.2099    mrr@20 : 0.0604
Tue 25 Mar 2025 10:52:55 INFO  Loading model structure and parameters from saved/EMCDR-Mar-25-2025_10-24-06.pth
Tue 25 Mar 2025 10:53:07 INFO  best valid : OrderedDict([('recall@20', 0.1348), ('ndcg@20', 0.0654), ('hit@20', 0.2099), ('mrr@20', 0.0599)])
Tue 25 Mar 2025 10:53:07 INFO  test result: OrderedDict([('recall@20', 0.1465), ('ndcg@20', 0.0706), ('hit@20', 0.2239), ('mrr@20', 0.0643)])
